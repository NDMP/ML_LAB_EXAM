import pandas as pd
from pgmpy.models import BayesianModel
from pgmpy.estimators import MaximumLikelihoodEstimator, VariableElimination

# 1. Load data
data = pd.read_csv("heart.csv")

# 2. Simple Bayesian structure
model = BayesianModel([
    ('cp', 'target'),
    ('thalach', 'target')
])

# 3. Train the model
model.fit(data, estimator=MaximumLikelihoodEstimator)

# 4. Inference (prediction)
infer = VariableElimination(model)

# Probability of heart disease when cp = 1
print(infer.query(['target'], {'cp': 1}))

# Probability of heart disease when thalach = 150
print(infer.query(['target'], {'thalach': 150}))
